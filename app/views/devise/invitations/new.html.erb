<div class="container-fluid h-100vh main loginwrapper">
  <%= render 'layouts/header' %>
    <div class="row align-items-center h100vh">
        <div class="col-sm-4 mx-auto login">
            <div class="login_box">
<% if user_signed_in? %>
     <% if current_user.role == "superadmin" %>
          <h2>Invite A Client Admin</h2>

          <%= form_for resource, :as => resource_name, :url => invitation_path(resource_name), :html => {:method => :post} do |f| %>
            <%= devise_error_messages! %>

          <% resource.class.invite_key_fields.each do |field| -%>
          <%= f.label :'User Role' %>
          <%= f.select(:role, User.roles.keys.map {|role| [role.titleize,role]}) %>
          </br>
          <%= f.label :'First Name' %>
          <%= f.text_field :first_name, class: 'form-control' %>

          <%= f.label :'Last Name' %>
          <%= f.text_field :last_name, class: 'form-control' %>

          <%= f.label :Email %>
          <%= f.email_field :email, class: 'form-control' %>

          <%= f.label :Company %>
          <%= f.text_field :company, class: 'form-control' %>

          <%= f.label :'Job Title' %>
          <%= f.text_field :job_title, class: 'form-control' %>

          <%= f.label :Phone %>
          <%= f.text_field :phone, class: 'form-control' %>

          <% end -%>

            <p><%= f.submit t("devise.invitations.new.submit_button") %></p>
         <% end %>

         <script>
         $(document).ready(function() {
             $('#userslist').DataTable();
         } );
         </script>

           <!-- <div>Signed in as... <%= current_user.email %></div> -->

         <table id="userslist" class="table table-striped table-bordered">
           <thead>
             <tr>
               <th scope="col">Id</th>
               <th scope="col">Tickets Open/Closed</th>
               <th scope="col">First</th>
               <th scope="col">Last</th>
               <th scope="col">Role</th>
               <th scope="col">Email</th>
               <th scope="col">Company</th>
               <th scope="col">Title</th>
               <th scope="col">Phone</th>
               <th scope="col">Delete</th>
             </tr>
           </thead>
           <tbody>
               <% @users.each do |user| %>
               <tr>
               <th scope="row"><%=user.id%></th>
               <td>Number of tickets</td>
               <td><%= user.first_name %></td>
               <td><%= user.last_name %></td>
               <td><%= user.role %></td>
               <td><%= user.email %></td>
               <td><%= user.company %></td>
               <td><%= user.job_title %></td>
               <td><%= number_to_phone(user.phone, delimiter: "-", area_code: true) %></td>
               <td><%= link_to user_path(user),method: :delete, data: { confirm: 'Are you sure?' } do %><%= fa_icon 'trash' %><% end %></td>
               </tr>
               <% end %>

           </tbody>
         </table>

     <% end %><!-- End of superadmin section -->
     <% else %>
     <h3>Please login to invite new users.</h3>
<% end %><!-- End of loggedin user -->
</div>
</div>
</div>
</div>
  <%= render 'layouts/footer' %>
